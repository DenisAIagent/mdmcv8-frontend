<!doctype html>
<html lang="fr">
  <head>
    <!-- CSP CONDITIONNEL - Premi√®re ex√©cution avant tout -->
    <script>
      // D√©tection imm√©diate de la route /links
      const currentURL = window.location.pathname + window.location.hash;
      const isLinksPage = window.location.pathname.includes('/links') || window.location.hash.includes('/links');
      
      console.log('üîç CSP DEBUG - URL compl√®te:', currentURL);
      console.log('üîç CSP DEBUG - pathname:', window.location.pathname);
      console.log('üîç CSP DEBUG - hash:', window.location.hash);
      console.log('üîç CSP DEBUG - isLinksPage:', isLinksPage);
      
      if (isLinksPage) {
        console.log('üîì CSP D√âSACTIV√â pour page /links - AUCUNE RESTRICTION');
        // Pas de CSP du tout pour /links
        window.cspDisabled = true;
      } else {
        console.log('üîí CSP ACTIV√â pour cette page');
        // CSP strict pour autres pages
        const cspContent = "default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https: http:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com https://connect.facebook.net https://www.googletagmanager.com https://www.google-analytics.com https://region1.google-analytics.com https://capi-automation.s3.us-east-2.amazonaws.com; style-src 'self' 'unsafe-inline' https: http:; font-src 'self' https: http: data: https://fonts.gstatic.com; img-src 'self' data: blob: https: http:; media-src 'self' blob: data: https: http:; connect-src 'self' https://blog.mdmcmusicads.com https://api.brevo.com https://region1.google-analytics.com https://www.google-analytics.com; frame-src 'self' https: http: https://85e392db.sibforms.com; object-src 'none'; base-uri 'self';";
        console.log('üîç CSP DEBUG - Injection CSP avec contenu:', cspContent.substring(0, 100) + '...');
        document.write('<meta http-equiv="Content-Security-Policy" content="' + cspContent + '">');
        window.cspDisabled = false;
      }
      
      // V√©rification finale
      setTimeout(() => {
        const cspMetas = document.querySelectorAll('meta[http-equiv="Content-Security-Policy"]');
        console.log('üîç CSP DEBUG - Nombre de meta CSP dans le DOM:', cspMetas.length);
        cspMetas.forEach((meta, i) => {
          console.log(`üîç CSP DEBUG - Meta ${i}:`, meta.content.substring(0, 100) + '...');
        });
      }, 100);
    </script>

    <!-- Google Tag Manager 1 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PFSK4LJZ');</script>
    <!-- End Google Tag Manager 1 -->

    <!-- Google Tag Manager 2 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-572GXWPP');</script>
    <!-- End Google Tag Manager 2 -->

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P11JTJ21NZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P11JTJ21NZ');
</script>


    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marketing Musical | YouTube Ads & Meta Ads pour Artistes | MDMC</title>
    <!-- Cache busting v1.2 - SEO Optimizations -->
    
    <!-- Meta tags par d√©faut optimis√©s CTR -->
    <meta name="description" content="Agence N¬∞1 marketing musical : +500 artistes accompagn√©s, +50M vues g√©n√©r√©es. YouTube Ads, Meta Ads, TikTok Pro. R√©sultats garantis pour artistes et labels. Devis gratuit." />
    
    <!-- Open Graph / Facebook optimis√© -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.mdmcmusicads.com/" />
    <meta property="og:title" content="Marketing Musical | YouTube Ads & Meta Ads pour Artistes | MDMC" />
    <meta property="og:description" content="Agence N¬∞1 marketing musical : +500 artistes accompagn√©s, +50M vues g√©n√©r√©es. YouTube Ads, Meta Ads, TikTok Pro. R√©sultats garantis pour artistes et labels. Devis gratuit." />
    <meta property="og:image" content="https://www.mdmcmusicads.com/assets/images/banniere site.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="MDMC Music Ads" />
    <meta property="og:locale" content="fr_FR" />
    
    <!-- Twitter optimis√© -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://www.mdmcmusicads.com/" />
    <meta property="twitter:title" content="Marketing Musical | YouTube Ads & Meta Ads pour Artistes | MDMC" />
    <meta property="twitter:description" content="Agence N¬∞1 marketing musical : +6M‚Ç¨ investis, +50M vues g√©n√©r√©es. YouTube Ads, Meta Ads, TikTok Pro. R√©sultats garantis pour artistes et labels. Devis gratuit." />
    <meta property="twitter:image" content="https://www.mdmcmusicads.com/assets/images/banniere site.jpg" />
    <meta property="twitter:site" content="@mdmcmusicads" />
    <meta property="twitter:creator" content="@mdmcmusicads" />
    
    
    <!-- Fonts Google optimis√©es avec preload -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500&display=swap">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Color Thief via CDN pour extraction couleurs SmartLinks -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.2/color-thief.umd.js"></script>
  </head>
  <body>
    <!-- Google Tag Manager 1 (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PFSK4LJZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager 1 (noscript) -->

    <!-- Google Tag Manager 2 (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-572GXWPP"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager 2 (noscript) -->
    
    <div id="root"></div>
    
    <!-- Script de redirection pour HashRouter et SEO -->
    <script>
      // Gestion des routes admin pour HashRouter
      (function() {
        const path = window.location.pathname;
        const hash = window.location.hash;
        const userAgent = navigator.userAgent || '';
        const isSocialBot = /facebook|twitter|linkedinbot|whatsapp|telegram|discord|slack|bot|crawler|spider/i.test(userAgent);
        
        // Redirection sp√©ciale pour les bots sociaux sur smartlinks
        if (isSocialBot && hash && hash.includes('/smartlinks/')) {
          const smartlinkMatch = hash.match(/#\/smartlinks\/([^\/]+)\/([^\/\?]+)/);
          if (smartlinkMatch) {
            const [, artistSlug, trackSlug] = smartlinkMatch;
            window.location.href = `/smartlinks/${artistSlug}/${trackSlug}`;
            return;
          }
        }
        
        // Redirection s√©curis√©e: acc√®s admin uniquement via login
        if (path.startsWith('/admin') && !hash) {
          window.location.replace('/#/admin/login');
          return;
        }
      })();
    </script>
    
    <script type="module" src="/src/main.jsx" crossorigin="anonymous"></script>
  </body>
</html>
